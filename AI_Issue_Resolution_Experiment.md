# AI Issue 解决指南

## 核心规则

### 1. 代码理解要求
- 必须主动读取和理解相关代码上下文
- 不能仅凭 Issue 描述就给出解决方案
- 需要充分分析代码库中的相关文件和逻辑

### 2. 独立思考要求
- 对于已有解决方案的 Issue，不能查看现有答案（包含 PR 以及 Issue 下的 comments），必须独立思考
- 对于未解决的 Issue，可以使用任何工具

### 3. Git 分支管理（重要）⭐
**对于涉及代码修改的 Issue：**
- 必须创建新的 Git 分支（分支名：issue-编号）
- 所有代码修改必须 commit 到该分支
- 禁止直接修改主分支
- 一个 Issue 使用一个独立分支

**工作流程：**
```bash
# 1. 创建并切换到新分支
git checkout -b issue-XXX

# 2. 进行代码修改
# ... 修改相关文件 ...

# 3. 提交更改
git add .
git commit -m "Fix: issue-XXX 简短描述

详细说明修复的问题和解决方案"
```

### 4. 测试和文档修改要求（重要）⭐
**测试文件：**
- 必须检查并更新相关测试文件
- 查找对应的测试文件（通常在同目录或 tests 目录下）
- 根据代码修改更新或添加测试用例
- 确保测试覆盖修复的场景
- 运行测试验证修改正确性

**文档更新：**
- 检查是否有相关文档需要更新（README, API docs, etc.）
- 如果修改了公开 API 或行为，必须更新文档
- 如果添加了新功能，必须添加文档说明

**提交要求：**
- 测试和文档修改应该包含在同一个 commit 中

### 5. 分析报告输出要求
- 分析报告必须保存为独立的 Markdown 文件
- 文件命名格式：`issue-[issue编号]-analysis.md`（如：`issue-31316-analysis.md`）
- 使用 `create_file` 工具创建报告文件

### 6. 工具使用最佳实践（重要）⭐
**文件操作规范：**
- ✅ 使用 `create_file` 工具创建新文件（特别是大型文件）
- ✅ 使用 `replace_string_in_file` 或 `multi_replace_string_in_file` 编辑现有文件
- ❌ 避免使用 heredoc (`<< 'EOF'`) 创建大型文件（>100行）
- ❌ 避免在单个 shell 命令中传输大量文本数据

**原因说明：**
- heredoc 方式创建大文件可能导致终端缓冲区溢出或连接超时
- VS Code 终端对单次命令的数据量有限制
- 使用专用文件操作工具更可靠、更高效

## 分析报告格式要求

你的每个 Issue 分析报告必须包含以下结构化内容：

### Issue #[编号] 解决方案

#### 1. 问题分析
- 问题现象
- 可能的根本原因
- 影响范围

#### 2. 代码调查
- 列出关键文件路径
- 相关函数/类/模块
- 发现的问题点

#### 3. 解决方案
- 修复思路
- 具体实现方法

#### 4. 代码修改（如适用）
**Git 操作记录：**
- 分支名：issue-XXX
- Commit Hash: [提交后的 hash 值]

**修改的文件：**
- `path/to/file.py` - 修改说明
- `path/to/another_file.py` - 修改说明

**Commit 信息：**
```
Fix: issue-XXX [简短描述]

[详细说明修复内容和原因]
```

#### 5. 测试修改（如适用）
**测试文件修改：**
- 修改的测试文件路径
- 新增或修改的测试用例
- 测试运行结果

#### 6. 文档更新（如适用）
**修改的文档：**
- 更新的文档文件路径
- 修改内容说明

#### 7. 验证方法
- 测试步骤
- 预期结果

#### 8. 潜在影响
- 是否影响其他功能
- 是否需要额外修改
